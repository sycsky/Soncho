# ================================
# 主配置文件 - 仅保留基础配置
# ================================
# 环境特定配置请在对应的配置文件中设置：
# - application-dev.yml      开发环境
# - application-local.yml    本地覆盖（不提交Git）
# - application-production.yml 生产环境

server:
  port: 8080
  # 支持在负载均衡器（如ALB）后面使用HTTPS
  # 当ALB配置了HTTPS时，应用需要信任X-Forwarded-*头
  forward-headers-strategy: framework

shopify:
  api-version: 2025-01

spring:
  application:
    name: nexus-support-ai
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:dev,local}  # 优先使用环境变量，默认 local
  datasource:
    hikari:
      maximum-pool-size: ${SPRING_DATASOURCE_MAX_POOL_SIZE:10}
      minimum-idle: ${SPRING_DATASOURCE_MIN_IDLE:2}
      connection-timeout: ${SPRING_DATASOURCE_CONNECTION_TIMEOUT:30000}
      validation-timeout: ${SPRING_DATASOURCE_VALIDATION_TIMEOUT:5000}
      idle-timeout: ${SPRING_DATASOURCE_IDLE_TIMEOUT:300000}
      max-lifetime: ${SPRING_DATASOURCE_MAX_LIFETIME:540000}
      keepalive-time: ${SPRING_DATASOURCE_KEEPALIVE_TIME:120000}
  servlet:
    multipart:
      enabled: true
      max-file-size: 10MB
      max-request-size: 50MB
  jackson:
    serialization:
      write-dates-as-timestamps: false

# LiteFlow 工作流引擎基础配置
liteflow:
  rule-source:
  print-execution-log: true
  when-max-wait-seconds: 60
  when-max-workers: 16
  monitor:
    enable-log: true
    period: 300000

# 知识库嵌入模型配置（通用）
knowledge:
  embedding:
    default-model: text-embedding-3-small
    default-dimension: 1536

# 文件存储通用配置
storage:
  max-file-size: 10485760
  allowed-image-types: image/jpeg,image/png,image/gif,image/webp,image/svg+xml
  allowed-document-types: application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,text/plain,text/csv
  allowed-video-types: video/mp4,video/webm,video/quicktime
  allowed-audio-types: audio/mpeg,audio/wav,audio/ogg

# 翻译服务通用配置
translation:
  target-languages:
    - code: zh-CN
      name: 中文简体
    - code: zh-TW
      name: 中文繁体
    - code: en
      name: English
    - code: ja
      name: 日本語
    - code: de
      name: Deutsch
    - code: fr
      name: Français
    - code: es
      name: Español
    - code: ar
      name: العربية
    - code: pt
      name: Português
    - code: ko
      name: 한국어
  default-system-language: zh-CN

# Resend 邮件服务配置
resend:
  api:
    key: ${RESEND_API_KEY:}  # 从环境变量获取 API Key
  from:
    email: ${RESEND_FROM_EMAIL:noreply@yourdomain.com}
    name: ${RESEND_FROM_NAME:Customer Service}

# 邮箱验证配置
email:
  verification:
    code:
      length: 6  # 验证码长度
      expiry:
        minutes: 10  # 验证码有效期（分钟）
    max:
      attempts:
        per:
          hour: 5  # 每小时最多发送次数
