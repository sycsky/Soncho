# TenantHibernateFilterAspect

## Class Profile
`TenantHibernateFilterAspect` is an AspectJ aspect that enforces multi-tenancy at the data access layer. It intercepts all Repository method calls and automatically enables a Hibernate Filter (`tenantFilter`) to restrict queries to the current tenant's data.

## Method Deep Dive

### `enableTenantFilter()`
- **Annotation**: `@Before("execution(* com.example.aikef..repository..*Repository.*(..))")`
- **Logic**:
    1.  Checks if SaaS mode is enabled (`app.saas.enabled`).
    2.  Retrieves the current `tenantId` from `TenantContext`.
    3.  If present, unwraps the Hibernate `Session` and enables the `tenantFilter`, setting the `tenantId` parameter.
    4.  This ensures that subsequent SQL queries generated by the repository call include a `WHERE tenant_id = ?` clause.

## Dependency Graph
- `TenantContext`: To get the current tenant ID.
- `EntityManager`: To access the Hibernate Session.

## Usage Guide
This aspect works automatically for all Spring Data JPA repositories in the project when `app.saas.enabled=true`. No manual invocation is required.

## Source Link
[TenantHibernateFilterAspect.java](file:///d:/ai_agent_work/ai_agent_workflow/ai_kef/src/main/java/com/example/aikef/saas/aspect/TenantHibernateFilterAspect.java)
